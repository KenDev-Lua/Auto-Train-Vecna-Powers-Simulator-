loadstring([[
local player = game.Players.LocalPlayer
local UIS = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local LocalizationService = game:GetService("LocalizationService")

-- Detectar idioma del jugador
local playerLocale = LocalizationService.RobloxLocaleId:sub(1,2) -- "es", "en", etc.
local texts = {}

if playerLocale == "es" then
    texts.Activate = "Activar"
    texts.Deactivate = "Desactivar"
    texts.Title = "Ken Hub"
elseif playerLocale == "en" then
    texts.Activate = "Activate"
    texts.Deactivate = "Deactivate"
    texts.Title = "Ken Hub"
else
    -- Idioma por defecto
    texts.Activate = "Activate"
    texts.Deactivate = "Deactivate"
    texts.Title = "Ken Hub"
end

local function createGUI()
    if player.PlayerGui:FindFirstChild("PersistentHUD") then return end

    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "PersistentHUD"
    ScreenGui.ResetOnSpawn = false
    ScreenGui.Parent = player:WaitForChild("PlayerGui")

    -- Panel blanco y azul
    local Frame = Instance.new("Frame")
    Frame.Size = UDim2.new(0,240,0,140)
    Frame.Position = UDim2.new(0.5,-120,0.5,-70)
    Frame.BackgroundColor3 = Color3.fromRGB(245,245,245)
    Frame.BorderSizePixel = 0
    Frame.Visible = false
    Frame.Parent = ScreenGui

    local FrameCorner = Instance.new("UICorner")
    FrameCorner.CornerRadius = UDim.new(0,12)
    FrameCorner.Parent = Frame

    local FrameShadow = Instance.new("UIStroke")
    FrameShadow.Color = Color3.fromRGB(0,120,255)
    FrameShadow.Thickness = 2
    FrameShadow.Parent = Frame

    -- Texto Ken Hub
    local Title = Instance.new("TextLabel")
    Title.Size = UDim2.new(1,0,0,30)
    Title.Position = UDim2.new(0,0,0,5)
    Title.BackgroundTransparency = 1
    Title.Text = texts.Title
    Title.TextColor3 = Color3.fromRGB(0,120,255)
    Title.Font = Enum.Font.GothamBold
    Title.TextSize = 20
    Title.Parent = Frame

    -- Animaci贸n pulsar usando UIScale
    local function addPressAnimation(button)
        local scale = Instance.new("UIScale")
        scale.Parent = button
        scale.Scale = 1
        button.MouseButton1Click:Connect(function()
            local tween1 = TweenService:Create(scale, TweenInfo.new(0.05, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {Scale = 0.9})
            local tween2 = TweenService:Create(scale, TweenInfo.new(0.05, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {Scale = 1})
            tween1:Play()
            tween1.Completed:Wait()
            tween2:Play()
        end)
    end

    -- Botones Activar / Desactivar
    local ActivateButton = Instance.new("TextButton")
    ActivateButton.Size = UDim2.new(0,100,0,50)
    ActivateButton.Position = UDim2.new(0.25,-50,0.5,10)
    ActivateButton.Text = texts.Activate
    ActivateButton.BackgroundColor3 = Color3.fromRGB(0,120,255)
    ActivateButton.TextColor3 = Color3.fromRGB(255,255,255)
    ActivateButton.Parent = Frame
    local ActivateCorner = Instance.new("UICorner")
    ActivateCorner.CornerRadius = UDim.new(0,10)
    ActivateCorner.Parent = ActivateButton
    addPressAnimation(ActivateButton)

    local DeactivateButton = Instance.new("TextButton")
    DeactivateButton.Size = UDim2.new(0,100,0,50)
    DeactivateButton.Position = UDim2.new(0.75,-50,0.5,10)
    DeactivateButton.Text = texts.Deactivate
    DeactivateButton.BackgroundColor3 = Color3.fromRGB(100,180,255)
    DeactivateButton.TextColor3 = Color3.fromRGB(255,255,255)
    DeactivateButton.Parent = Frame
    local DeactivateCorner = Instance.new("UICorner")
    DeactivateCorner.CornerRadius = UDim.new(0,10)
    DeactivateCorner.Parent = DeactivateButton
    addPressAnimation(DeactivateButton)

    local activating = false
    local activateLoop

    ActivateButton.MouseButton1Click:Connect(function()
        if not activating then
            activating = true
            activateLoop = spawn(function()
                while activating do
                    game:GetService("ReplicatedStorage").events.train:FireServer(player)
                    wait()
                end
            end)
        end
    end)

    DeactivateButton.MouseButton1Click:Connect(function()
        activating = false
    end)

    -- Bot贸n cerrar X
    local CloseButton = Instance.new("TextButton")
    CloseButton.Text = "X"
    CloseButton.Size = UDim2.new(0,25,0,25)
    CloseButton.Position = UDim2.new(1,-30,0,5)
    CloseButton.BackgroundColor3 = Color3.fromRGB(200,0,0)
    CloseButton.TextColor3 = Color3.fromRGB(255,255,255)
    CloseButton.Parent = Frame
    local CloseCorner = Instance.new("UICorner")
    CloseCorner.CornerRadius = UDim.new(0,4)
    CloseCorner.Parent = CloseButton
    addPressAnimation(CloseButton)

    CloseButton.MouseButton1Click:Connect(function()
        activating = false
        ScreenGui:Destroy()
    end)

    -- Bot贸n flotante circular
    local OpenButton = Instance.new("ImageButton")
    OpenButton.Size = UDim2.new(0,55,0,55)
    OpenButton.Position = UDim2.new(0.5,-27,0.5,-200)
    OpenButton.Image = "rbxassetid://17856125799"
    OpenButton.BackgroundTransparency = 1
    OpenButton.Parent = ScreenGui
    local OpenCorner = Instance.new("UICorner")
    OpenCorner.CornerRadius = UDim.new(0.5,0)
    OpenCorner.Parent = OpenButton
    local OpenShadow = Instance.new("UIStroke")
    OpenShadow.Color = Color3.fromRGB(0,120,255)
    OpenShadow.Thickness = 2
    OpenShadow.Parent = OpenButton
    addPressAnimation(OpenButton)

    -- Funci贸n para mover objetos
    local function makeDraggable(guiObject)
        local dragging = false
        local dragInput
        local dragStart = Vector2.new()
        local startPos = Vector2.new()

        guiObject.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 or
               input.UserInputType == Enum.UserInputType.Touch then
                dragging = true
                dragStart = input.Position
                startPos = Vector2.new(guiObject.Position.X.Offset, guiObject.Position.Y.Offset)
                input.Changed:Connect(function()
                    if input.UserInputState == Enum.UserInputState.End then
                        dragging = false
                    end
                end)
            end
        end)

        guiObject.InputChanged:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseMovement or
               input.UserInputType == Enum.UserInputType.Touch then
                dragInput = input
            end
        end)

        UIS.InputChanged:Connect(function(input)
            if dragging and input == dragInput then
                local delta = input.Position - dragStart
                local newX = math.clamp(startPos.X + delta.X,0,workspace.CurrentCamera.ViewportSize.X - guiObject.AbsoluteSize.X)
                local newY = math.clamp(startPos.Y + delta.Y,0,workspace.CurrentCamera.ViewportSize.Y - guiObject.AbsoluteSize.Y)
                guiObject.Position = UDim2.new(0,newX,0,newY)
            end
        end)
    end

    makeDraggable(OpenButton)
    makeDraggable(Frame)

    -- Click para abrir/ocultar panel
    OpenButton.MouseButton1Click:Connect(function()
        if not dragging then
            Frame.Visible = not Frame.Visible
        end
    end)
end

-- Crear GUI inicial
createGUI()

-- Persistir al respawnear
player.CharacterAdded:Connect(function()
    createGUI()
end)
]])()
